(function(t){"use strict";function e(){c&&(c.setAttribute("height",""),c.setAttribute("height",h.height||h.documentElement.scrollHeight))}function n(){c&&d.removeChild(c),c=h.createElement("iframe"),c.setAttribute("width","100%"),"string"==typeof u&&c.setAttribute("sandbox",u),e(),d.appendChild(c)}function s(t){n(),c.addEventListener("load",function(){a("load",null)},!1);var e=c.contentWindow.document;e.open(),e.write(t),e.close()}function a(e,n){var s=f.stringify({data:n,type:e,secret:l});t.parent.postMessage(s,"*")}function o(t,e){var n=c.contentWindow.Error;(t&&t instanceof Error||t instanceof n)&&(t={message:t.message,stack:t.stack,type:t.type,arguments:t.arguments,__errorType__:(t.constructor+"").trim().match(/^function ([^\(\s]+)/)[1]}),"function"==typeof e&&(e+=""),a("evaljs",{error:t,result:e})}function i(t){var e=null;try{e=c.contentWindow.eval(t)}catch(n){throw o(n,null),n}o(null,e)}function r(){a("html",c.contentWindow.document.documentElement.outerHTML)}var c,l,u,h=t.document,d=h.querySelector("body"),f=t.JSON,p={load:s,evaljs:i,html:r};t.addEventListener("message",function(t){var e;try{e=f.parse(t.data)}catch(n){return}var s=e.type,a=e.data;if(e.secret)if(l||"handshake"!==e.type){if(e.secret!==l)return;p[s](a)}else l=e.secret,u=e.data},!1),t.addEventListener("resize",e),t.stuffEmit=function(t,e){a("custom",{type:t,data:e})}})(window);